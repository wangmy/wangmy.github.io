<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ÂâçË®Ä ËøôÁØáÊñáÁ´†ÁöÑÊ†∏ÂøÉÁõÆÁöÑÊòØË∑üÁùÄËãπÊûúÊ∫êÁ†ÅÔºåÊ∑±Â∫¶Â≠¶‰π†Âπ∂ÁêÜËß£iOS APPÂêØÂä®ËøáÁ®ã„ÄÇ
Âü∫Á°ÄÊ¶ÇÂøµ ÂÜ∑ÂêØÂä® Ê≥®ÊÑèÔºöÂú®Êó•Â∏∏ÂºÄÂèëÊàñÊµãËØïÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÔºåËß¶ÂèëÂÜ∑ÂêØÂä®Áä∂ÊÄÅÔºå‰ºöÊâãÂä®kill appÔºåÁÑ∂ÂêéÁÇπÂáªÂêØÂä®„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÁöÑÂÜ∑ÂêØÂä®ÂèØËÉΩ‰ºö‰∏é‰∏äËø∞ÂÜ∑ÂêØÂä®ËøáÁ®ãÁöÑÊ≠•È™§Á®çÂæÆÂ∞ë‰∫õÔºåÂèØ‰ª•ÈÖçÂêàInstrumentË∞ÉËØïÈ™åËØÅÔºàËøô‰∏™Âú®ÊñáÁ´†ÁªìÂ∞æ‰ºöÂÅö‰ªãÁªçÔºâ„ÄÇÂõ†Ê≠§ÈÄöÂ∏∏Â¶ÇÊûúË¶ÅÊ®°ÊãüÊõ¥ÁúüÂÆûÂÖ®Èù¢ÁöÑÂÜ∑ÂêØÂä®ÔºåÂú®kill appÂêéÔºåÂÜçÊâìÂºÄ/Âπ∂Á®çÂæÆ‰ΩøÁî®Âá†‰∏™ÂÖ∂‰ªñapp„ÄÇ
ÈÄöÂ∏∏ËØ¥ÁöÑÂêØÂä®Ôºå‰πüÊòØÊåáÁöÑÂÜ∑ÂêØÂä®ÔºõÂêØÂä®‰ºòÂåñÂ§ßÈÉ®ÂàÜ‰πüÊòØÂÅöÂÜ∑ÂêØÂä®ÈÉ®ÂàÜÁöÑÊÄßËÉΩ‰ºòÂåñ ÊöÇ‰∏îÂèØ‰ª•ÊääÂÜ∑ÂêØÂä®ÂàÜ‰∏∫Âá†‰∏™Èò∂ÊÆµÔºö
T1: main‰πãÂâçÔºåÂä†ËΩΩAppÂèØÊâßË°åÊñá‰ª∂Âà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑÂä†ËΩΩ&amp;amp;ÈìæÊé•Á≠âÂ∑•‰ΩúÔºåÊúÄÂêéÊâßË°åÂà∞main()ÂáΩÊï∞ T2: main‰πãÂêéÔºådidFinishLaunching‰πãÂâçÔºåËøôÈÉ®ÂàÜÂºÄÂèëÊòØÂèØ‰ª•ÁõëÂê¨Âà∞ÁöÑ T3: didFinishLaunching‰πãÂêéÔºåÂêØÂä®È°µÈù¢Âá∫Áé∞‰πãÂâçÔºå‰πüÊòØÂèØ‰ª•ÁõëÂê¨ÁöÑ ÁÉ≠ÂêØÂä® ÁÉ≠ÂêØÂä®ÁöÑÈò∂ÊÆµÂíåÁä∂ÊÄÅÈÉΩÊòØÂèØÁõëÂê¨ÁöÑÔºå‰∏çÂÅöËøáÂ§ö‰ªãÁªç„ÄÇ
Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ 1 2 3 4 5 6 7 8 9 10 11 12 ÂêØÂä®Á®ãÂ∫è willFinishLaunchingWithOptions didFinishLaunchingWithOptions applicationDidBecomeActive Êåâ‰∏ãhomeÈîÆ applicationWillResignActive applicationDidEnterBackground ÂèåÂáªhomeÈîÆÔºåÂÜçÊâìÂºÄÁ®ãÂ∫è applicationWillEnterForeground applicationDidBecomeActive ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã Â∫îÁî®Á®ãÂ∫èÂä†ËΩΩËøáÁ®ã‰∏≠‰ºö‰æùËµñÂæàÂ§öÂ∫ïÂ±ÇÂ∫ìÔºåËøô‰∫õÂ∫ïÂ±ÇÂ∫ìÂÖ∂ÂÆûÂ∞±ÊòØÂèØÊâßË°åÁöÑ‰ª£Á†ÅÁöÑ‰∫åËøõÂà∂ÔºåË¢´Êìç‰ΩúÁ≥ªÁªüÂÜôÂÖ•Âà∞ÂÜÖÂ≠ò„ÄÇ ÈùôÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö .a, .lib Âú®ÈìæÊé•Èò∂ÊÆµÔºå‰ºöÂ∞ÜÊ±áÁºñÁîüÊàêÁöÑÁõÆÊ†á‰∏éÂºïÁî®ÁöÑÂ∫ì‰∏ÄËµ∑ÈìæÊé•ÊâìÂåÖÂà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠„ÄÇ Âä®ÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö frameworkÔºå.so, .dllÔºåUIKIT.frameworkÔºå libsystemÔºå libdispatchÔºålibobjc Âä®ÊÄÅÂ∫ìÊ†πÊçÆÈúÄË¶ÅÁºñËØëÔºåÂä®ÊÄÅÂä†ËΩΩÔºåÂú®ËøêË°åÊó∂ÊâçË¢´ËΩΩÂÖ•ÔºåËäÇÁ∫¶ËµÑÊ∫êÔºåÂáèÂ∞è‰ΩìÁßØ„ÄÇ ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£ mainÂáΩÊï∞ÔºåÊñ≠ÁÇπÂ†ÜÊ†àÔºàDebug/Debug Workflow/Always Show Disassembly ÂºÄÂêØÊ±áÁºñDebugÔºâÂèØ‰ª•ÁúãÂà∞ÊòØÊúÄÊó©ÊòØÔºödyldÁöÑstart: Âú®ÁâπÊÆäÊñπÊ≥ï &#43; loadÔºàÊàñ&#43; (void)initializeÔºâÊñπÊ≥ïÔºåÂú®Ê≠§Êñ≠ÁÇπ ÂàùÊé¢ÁªìËÆ∫Ôºö _dyld_start -&amp;gt; &#43;load -&amp;gt; main -&amp;gt; &#43;initialize'>
<title>iOSÂ∫îÁî®Á®ãÂ∫èÂä†ËΩΩ</title>

<link rel='canonical' href='/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='iOSÂ∫îÁî®Á®ãÂ∫èÂä†ËΩΩ'>
<meta property='og:description' content='ÂâçË®Ä ËøôÁØáÊñáÁ´†ÁöÑÊ†∏ÂøÉÁõÆÁöÑÊòØË∑üÁùÄËãπÊûúÊ∫êÁ†ÅÔºåÊ∑±Â∫¶Â≠¶‰π†Âπ∂ÁêÜËß£iOS APPÂêØÂä®ËøáÁ®ã„ÄÇ
Âü∫Á°ÄÊ¶ÇÂøµ ÂÜ∑ÂêØÂä® Ê≥®ÊÑèÔºöÂú®Êó•Â∏∏ÂºÄÂèëÊàñÊµãËØïÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÔºåËß¶ÂèëÂÜ∑ÂêØÂä®Áä∂ÊÄÅÔºå‰ºöÊâãÂä®kill appÔºåÁÑ∂ÂêéÁÇπÂáªÂêØÂä®„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÁöÑÂÜ∑ÂêØÂä®ÂèØËÉΩ‰ºö‰∏é‰∏äËø∞ÂÜ∑ÂêØÂä®ËøáÁ®ãÁöÑÊ≠•È™§Á®çÂæÆÂ∞ë‰∫õÔºåÂèØ‰ª•ÈÖçÂêàInstrumentË∞ÉËØïÈ™åËØÅÔºàËøô‰∏™Âú®ÊñáÁ´†ÁªìÂ∞æ‰ºöÂÅö‰ªãÁªçÔºâ„ÄÇÂõ†Ê≠§ÈÄöÂ∏∏Â¶ÇÊûúË¶ÅÊ®°ÊãüÊõ¥ÁúüÂÆûÂÖ®Èù¢ÁöÑÂÜ∑ÂêØÂä®ÔºåÂú®kill appÂêéÔºåÂÜçÊâìÂºÄ/Âπ∂Á®çÂæÆ‰ΩøÁî®Âá†‰∏™ÂÖ∂‰ªñapp„ÄÇ
ÈÄöÂ∏∏ËØ¥ÁöÑÂêØÂä®Ôºå‰πüÊòØÊåáÁöÑÂÜ∑ÂêØÂä®ÔºõÂêØÂä®‰ºòÂåñÂ§ßÈÉ®ÂàÜ‰πüÊòØÂÅöÂÜ∑ÂêØÂä®ÈÉ®ÂàÜÁöÑÊÄßËÉΩ‰ºòÂåñ ÊöÇ‰∏îÂèØ‰ª•ÊääÂÜ∑ÂêØÂä®ÂàÜ‰∏∫Âá†‰∏™Èò∂ÊÆµÔºö
T1: main‰πãÂâçÔºåÂä†ËΩΩAppÂèØÊâßË°åÊñá‰ª∂Âà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑÂä†ËΩΩ&amp;amp;ÈìæÊé•Á≠âÂ∑•‰ΩúÔºåÊúÄÂêéÊâßË°åÂà∞main()ÂáΩÊï∞ T2: main‰πãÂêéÔºådidFinishLaunching‰πãÂâçÔºåËøôÈÉ®ÂàÜÂºÄÂèëÊòØÂèØ‰ª•ÁõëÂê¨Âà∞ÁöÑ T3: didFinishLaunching‰πãÂêéÔºåÂêØÂä®È°µÈù¢Âá∫Áé∞‰πãÂâçÔºå‰πüÊòØÂèØ‰ª•ÁõëÂê¨ÁöÑ ÁÉ≠ÂêØÂä® ÁÉ≠ÂêØÂä®ÁöÑÈò∂ÊÆµÂíåÁä∂ÊÄÅÈÉΩÊòØÂèØÁõëÂê¨ÁöÑÔºå‰∏çÂÅöËøáÂ§ö‰ªãÁªç„ÄÇ
Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ 1 2 3 4 5 6 7 8 9 10 11 12 ÂêØÂä®Á®ãÂ∫è willFinishLaunchingWithOptions didFinishLaunchingWithOptions applicationDidBecomeActive Êåâ‰∏ãhomeÈîÆ applicationWillResignActive applicationDidEnterBackground ÂèåÂáªhomeÈîÆÔºåÂÜçÊâìÂºÄÁ®ãÂ∫è applicationWillEnterForeground applicationDidBecomeActive ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã Â∫îÁî®Á®ãÂ∫èÂä†ËΩΩËøáÁ®ã‰∏≠‰ºö‰æùËµñÂæàÂ§öÂ∫ïÂ±ÇÂ∫ìÔºåËøô‰∫õÂ∫ïÂ±ÇÂ∫ìÂÖ∂ÂÆûÂ∞±ÊòØÂèØÊâßË°åÁöÑ‰ª£Á†ÅÁöÑ‰∫åËøõÂà∂ÔºåË¢´Êìç‰ΩúÁ≥ªÁªüÂÜôÂÖ•Âà∞ÂÜÖÂ≠ò„ÄÇ ÈùôÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö .a, .lib Âú®ÈìæÊé•Èò∂ÊÆµÔºå‰ºöÂ∞ÜÊ±áÁºñÁîüÊàêÁöÑÁõÆÊ†á‰∏éÂºïÁî®ÁöÑÂ∫ì‰∏ÄËµ∑ÈìæÊé•ÊâìÂåÖÂà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠„ÄÇ Âä®ÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö frameworkÔºå.so, .dllÔºåUIKIT.frameworkÔºå libsystemÔºå libdispatchÔºålibobjc Âä®ÊÄÅÂ∫ìÊ†πÊçÆÈúÄË¶ÅÁºñËØëÔºåÂä®ÊÄÅÂä†ËΩΩÔºåÂú®ËøêË°åÊó∂ÊâçË¢´ËΩΩÂÖ•ÔºåËäÇÁ∫¶ËµÑÊ∫êÔºåÂáèÂ∞è‰ΩìÁßØ„ÄÇ ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£ mainÂáΩÊï∞ÔºåÊñ≠ÁÇπÂ†ÜÊ†àÔºàDebug/Debug Workflow/Always Show Disassembly ÂºÄÂêØÊ±áÁºñDebugÔºâÂèØ‰ª•ÁúãÂà∞ÊòØÊúÄÊó©ÊòØÔºödyldÁöÑstart: Âú®ÁâπÊÆäÊñπÊ≥ï &#43; loadÔºàÊàñ&#43; (void)initializeÔºâÊñπÊ≥ïÔºåÂú®Ê≠§Êñ≠ÁÇπ ÂàùÊé¢ÁªìËÆ∫Ôºö _dyld_start -&amp;gt; &#43;load -&amp;gt; main -&amp;gt; &#43;initialize'>
<meta property='og:url' content='/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/'>
<meta property='og:site_name' content='YoyoWong'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2022-03-25T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-03-25T00:00:00&#43;00:00'/><meta property='og:image' content='/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933.jpg' />
<meta name="twitter:title" content="iOSÂ∫îÁî®Á®ãÂ∫èÂä†ËΩΩ">
<meta name="twitter:description" content="ÂâçË®Ä ËøôÁØáÊñáÁ´†ÁöÑÊ†∏ÂøÉÁõÆÁöÑÊòØË∑üÁùÄËãπÊûúÊ∫êÁ†ÅÔºåÊ∑±Â∫¶Â≠¶‰π†Âπ∂ÁêÜËß£iOS APPÂêØÂä®ËøáÁ®ã„ÄÇ
Âü∫Á°ÄÊ¶ÇÂøµ ÂÜ∑ÂêØÂä® Ê≥®ÊÑèÔºöÂú®Êó•Â∏∏ÂºÄÂèëÊàñÊµãËØïÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÔºåËß¶ÂèëÂÜ∑ÂêØÂä®Áä∂ÊÄÅÔºå‰ºöÊâãÂä®kill appÔºåÁÑ∂ÂêéÁÇπÂáªÂêØÂä®„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÁöÑÂÜ∑ÂêØÂä®ÂèØËÉΩ‰ºö‰∏é‰∏äËø∞ÂÜ∑ÂêØÂä®ËøáÁ®ãÁöÑÊ≠•È™§Á®çÂæÆÂ∞ë‰∫õÔºåÂèØ‰ª•ÈÖçÂêàInstrumentË∞ÉËØïÈ™åËØÅÔºàËøô‰∏™Âú®ÊñáÁ´†ÁªìÂ∞æ‰ºöÂÅö‰ªãÁªçÔºâ„ÄÇÂõ†Ê≠§ÈÄöÂ∏∏Â¶ÇÊûúË¶ÅÊ®°ÊãüÊõ¥ÁúüÂÆûÂÖ®Èù¢ÁöÑÂÜ∑ÂêØÂä®ÔºåÂú®kill appÂêéÔºåÂÜçÊâìÂºÄ/Âπ∂Á®çÂæÆ‰ΩøÁî®Âá†‰∏™ÂÖ∂‰ªñapp„ÄÇ
ÈÄöÂ∏∏ËØ¥ÁöÑÂêØÂä®Ôºå‰πüÊòØÊåáÁöÑÂÜ∑ÂêØÂä®ÔºõÂêØÂä®‰ºòÂåñÂ§ßÈÉ®ÂàÜ‰πüÊòØÂÅöÂÜ∑ÂêØÂä®ÈÉ®ÂàÜÁöÑÊÄßËÉΩ‰ºòÂåñ ÊöÇ‰∏îÂèØ‰ª•ÊääÂÜ∑ÂêØÂä®ÂàÜ‰∏∫Âá†‰∏™Èò∂ÊÆµÔºö
T1: main‰πãÂâçÔºåÂä†ËΩΩAppÂèØÊâßË°åÊñá‰ª∂Âà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑÂä†ËΩΩ&amp;amp;ÈìæÊé•Á≠âÂ∑•‰ΩúÔºåÊúÄÂêéÊâßË°åÂà∞main()ÂáΩÊï∞ T2: main‰πãÂêéÔºådidFinishLaunching‰πãÂâçÔºåËøôÈÉ®ÂàÜÂºÄÂèëÊòØÂèØ‰ª•ÁõëÂê¨Âà∞ÁöÑ T3: didFinishLaunching‰πãÂêéÔºåÂêØÂä®È°µÈù¢Âá∫Áé∞‰πãÂâçÔºå‰πüÊòØÂèØ‰ª•ÁõëÂê¨ÁöÑ ÁÉ≠ÂêØÂä® ÁÉ≠ÂêØÂä®ÁöÑÈò∂ÊÆµÂíåÁä∂ÊÄÅÈÉΩÊòØÂèØÁõëÂê¨ÁöÑÔºå‰∏çÂÅöËøáÂ§ö‰ªãÁªç„ÄÇ
Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ 1 2 3 4 5 6 7 8 9 10 11 12 ÂêØÂä®Á®ãÂ∫è willFinishLaunchingWithOptions didFinishLaunchingWithOptions applicationDidBecomeActive Êåâ‰∏ãhomeÈîÆ applicationWillResignActive applicationDidEnterBackground ÂèåÂáªhomeÈîÆÔºåÂÜçÊâìÂºÄÁ®ãÂ∫è applicationWillEnterForeground applicationDidBecomeActive ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã Â∫îÁî®Á®ãÂ∫èÂä†ËΩΩËøáÁ®ã‰∏≠‰ºö‰æùËµñÂæàÂ§öÂ∫ïÂ±ÇÂ∫ìÔºåËøô‰∫õÂ∫ïÂ±ÇÂ∫ìÂÖ∂ÂÆûÂ∞±ÊòØÂèØÊâßË°åÁöÑ‰ª£Á†ÅÁöÑ‰∫åËøõÂà∂ÔºåË¢´Êìç‰ΩúÁ≥ªÁªüÂÜôÂÖ•Âà∞ÂÜÖÂ≠ò„ÄÇ ÈùôÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö .a, .lib Âú®ÈìæÊé•Èò∂ÊÆµÔºå‰ºöÂ∞ÜÊ±áÁºñÁîüÊàêÁöÑÁõÆÊ†á‰∏éÂºïÁî®ÁöÑÂ∫ì‰∏ÄËµ∑ÈìæÊé•ÊâìÂåÖÂà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠„ÄÇ Âä®ÊÄÅÂ∫ì ÊØîÂ¶ÇÔºö frameworkÔºå.so, .dllÔºåUIKIT.frameworkÔºå libsystemÔºå libdispatchÔºålibobjc Âä®ÊÄÅÂ∫ìÊ†πÊçÆÈúÄË¶ÅÁºñËØëÔºåÂä®ÊÄÅÂä†ËΩΩÔºåÂú®ËøêË°åÊó∂ÊâçË¢´ËΩΩÂÖ•ÔºåËäÇÁ∫¶ËµÑÊ∫êÔºåÂáèÂ∞è‰ΩìÁßØ„ÄÇ ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£ mainÂáΩÊï∞ÔºåÊñ≠ÁÇπÂ†ÜÊ†àÔºàDebug/Debug Workflow/Always Show Disassembly ÂºÄÂêØÊ±áÁºñDebugÔºâÂèØ‰ª•ÁúãÂà∞ÊòØÊúÄÊó©ÊòØÔºödyldÁöÑstart: Âú®ÁâπÊÆäÊñπÊ≥ï &#43; loadÔºàÊàñ&#43; (void)initializeÔºâÊñπÊ≥ïÔºåÂú®Ê≠§Êñ≠ÁÇπ ÂàùÊé¢ÁªìËÆ∫Ôºö _dyld_start -&amp;gt; &#43;load -&amp;gt; main -&amp;gt; &#43;initialize"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu8ad42cd0bb16d295ddead16cde881b2f_58443_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üåª</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">YoyoWong</a></h1>
            <h2 class="site-description">Welcome üëèüëèüëè.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/wangmy'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>ÈìæÊé•</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ÊöóËâ≤Ê®°Âºè</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ÂâçË®Ä">ÂâçË®Ä</a></li>
    <li><a href="#Âü∫Á°ÄÊ¶ÇÂøµ">Âü∫Á°ÄÊ¶ÇÂøµ</a>
      <ol>
        <li><a href="#ÂÜ∑ÂêØÂä®">ÂÜ∑ÂêØÂä®</a></li>
        <li><a href="#ÁÉ≠ÂêØÂä®">ÁÉ≠ÂêØÂä®</a></li>
        <li><a href="#Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ">Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ</a></li>
      </ol>
    </li>
    <li><a href="#ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã">ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã</a>
      <ol>
        <li><a href="#ÈùôÊÄÅÂ∫ì">ÈùôÊÄÅÂ∫ì</a></li>
        <li><a href="#Âä®ÊÄÅÂ∫ì">Âä®ÊÄÅÂ∫ì</a></li>
      </ol>
    </li>
    <li><a href="#ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£">ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£</a>
      <ol>
        <li><a href="#ÂàùÊé¢ÁªìËÆ∫">ÂàùÊé¢ÁªìËÆ∫Ôºö</a></li>
        <li><a href="#__dyld_start">__dyld_start</a></li>
        <li><a href="#ÂÖ•Âè£ÂáΩÊï∞-uintptr_t-start">ÂÖ•Âè£ÂáΩÊï∞ uintptr_t start(‚Ä¶)</a></li>
        <li><a href="#Ê†∏ÂøÉÂáΩÊï∞-dyld_main">Ê†∏ÂøÉÂáΩÊï∞ dyld::_main</a></li>
      </ol>
    </li>
    <li><a href="#dyldÊ†∏ÂøÉÊ∫êÁ†ÅÊµÅÁ®ã">dyldÊ†∏ÂøÉÊ∫êÁ†ÅÊµÅÁ®ã</a>
      <ol>
        <li><a href="#reloadallimages">reloadAllImages</a>
          <ol>
            <li><a href="#ÂÆû‰æãÂåñ‰∏ªÁ®ãÂ∫è">ÂÆû‰æãÂåñ‰∏ªÁ®ãÂ∫è</a></li>
            <li><a href="#Âä†ËΩΩ‰ªª‰ΩïÊèíÂÖ•Âä®ÊÄÅÂ∫ì">Âä†ËΩΩ‰ªª‰ΩïÊèíÂÖ•Âä®ÊÄÅÂ∫ì</a></li>
            <li><a href="#ÈìæÊé•Â∫ì">ÈìæÊé•Â∫ì</a></li>
          </ol>
        </li>
        <li><a href="#ËøêË°åÊâÄÊúâÂàùÂßãÂåñÁ®ãÂ∫è---run-all-initializers">ËøêË°åÊâÄÊúâÂàùÂßãÂåñÁ®ãÂ∫è - run all initializers</a>
          <ol>
            <li><a href="#runinitializers">runInitializers</a></li>
          </ol>
        </li>
        <li><a href="#ÂõûË∞ÉÁõëÂê¨">ÂõûË∞ÉÁõëÂê¨</a>
          <ol>
            <li><a href="#ÂèØ‰ª•ÁåúÊµãÊµÅÁ®ã">ÂèØ‰ª•ÁåúÊµãÊµÅÁ®ã</a></li>
            <li><a href="#ÊèêÂá∫ÁñëÈóÆ">ÊèêÂá∫ÁñëÈóÆ</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#libobjc-ÂêØÂä®Ê†∏ÂøÉÊ∫êÁ†ÅÂàÜÊûê">libobjc ÂêØÂä®Ê†∏ÂøÉÊ∫êÁ†ÅÂàÜÊûê</a>
      <ol>
        <li><a href="#ÊâæÂà∞-_dyld_objc_notify_register-ÂÖ•Âè£">ÊâæÂà∞ _dyld_objc_notify_register ÂÖ•Âè£</a></li>
        <li><a href="#build--run-libobjc">build &amp; run libobjc</a></li>
        <li><a href="#Á°ÆËÆ§Âü∫Á°ÄÊµÅÁ®ã">Á°ÆËÆ§Âü∫Á°ÄÊµÅÁ®ã</a></li>
      </ol>
    </li>
    <li><a href="#È™åËØÅÊµÅÁ®ã---ÈÖçÂêàlibsytemÊ∫êÁ†ÅlibdispatchÊ∫êÁ†Å">È™åËØÅÊµÅÁ®ã - ÈÖçÂêàlibSytemÊ∫êÁ†ÅÔºålibdispatchÊ∫êÁ†Å</a>
      <ol>
        <li><a href="#dyld-ÂàùÂßãÂåñÂøÖÈ°ªÁ°Æ‰øùÂÖàÂÆåÊàê-libsystem-ÂàùÂßãÂåñ">dyld ÂàùÂßãÂåñÂøÖÈ°ªÁ°Æ‰øùÂÖàÂÆåÊàê libSystem ÂàùÂßãÂåñ</a></li>
        <li><a href="#libsytem-initializer">libSytem initializer</a></li>
        <li><a href="#libdispatch_init">libdispatch_init</a></li>
      </ol>
    </li>
    <li><a href="#ÂêØÂä®ÂÆåÊï¥ÊµÅÁ®ã">ÂêØÂä®ÂÆåÊï¥ÊµÅÁ®ã</a>
      <ol>
        <li><a href="#ÁÆÄÂåñÊµÅÁ®ãÂõæ">ÁÆÄÂåñÊµÅÁ®ãÂõæ</a></li>
        <li><a href="#ËØ¶ÁªÜÊµÅÁ®ãÂõæ">ËØ¶ÁªÜÊµÅÁ®ãÂõæ</a></li>
      </ol>
    </li>
    <li><a href="#ÂÆûÈôÖÂ∫îÁî®">ÂÆûÈôÖÂ∫îÁî®</a>
      <ol>
        <li><a href="#main‰πãÂâç---Ë∞ÉËØï--ÁõëÊµã">main‰πãÂâç - Ë∞ÉËØï &amp; ÁõëÊµã</a>
          <ol>
            <li><a href="#xcodeÊâìÂç∞pre-mainÁöÑÊó∂Èó¥ÂºÄÂèëÁéØÂ¢Éxcode-dyld_print_statics--1">XcodeÊâìÂç∞pre-mainÁöÑÊó∂Èó¥ÔºöÂºÄÂèëÁéØÂ¢ÉXcode DYLD_PRINT_STATICS = 1</a></li>
            <li><a href="#instrument---systemtrace--timeprofiler">Instrument - SystemTrace / TimeProfiler</a></li>
            <li><a href="#xcodeÈÖçÁΩÆlinkmapÊãøÂà∞linkmapÊñá‰ª∂ÂàÜÊûê">XcodeÈÖçÁΩÆLinkMapÔºåÊãøÂà∞LinkMapÊñá‰ª∂ÔºåÂàÜÊûê</a></li>
            <li><a href="#ÂÖ∂‰ªñ12‰∏çÊé®ËçêÂºÄÊãìÊÄùË∑Ø">ÂÖ∂‰ªñÔºà1Ôºå2‰∏çÊé®ËçêÔºåÂºÄÊãìÊÄùË∑ØÔºâ</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#objcÊ∫êÁ†Å‰∏ãËΩΩ">objcÊ∫êÁ†Å‰∏ãËΩΩ</a>
      <ol>
        <li><a href="#objc818">objc818</a></li>
        <li><a href="#objc838">objc838</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/">
                <img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933_hu0cfc4d1f5c3e28c9d5ab40ace509f822_113354_800x0_resize_q75_box.jpg"
                        srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933_hu0cfc4d1f5c3e28c9d5ab40ace509f822_113354_800x0_resize_q75_box.jpg 800w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933_hu0cfc4d1f5c3e28c9d5ab40ace509f822_113354_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="484" 
                        loading="lazy"
                        alt="Featured image of post iOSÂ∫îÁî®Á®ãÂ∫èÂä†ËΩΩ" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ios/" >
                iOS
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/">iOSÂ∫îÁî®Á®ãÂ∫èÂä†ËΩΩ</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 25, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 9 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="ÂâçË®Ä">ÂâçË®Ä</h2>
<p>ËøôÁØáÊñáÁ´†ÁöÑÊ†∏ÂøÉÁõÆÁöÑÊòØË∑üÁùÄËãπÊûúÊ∫êÁ†ÅÔºåÊ∑±Â∫¶Â≠¶‰π†Âπ∂ÁêÜËß£iOS APPÂêØÂä®ËøáÁ®ã„ÄÇ</p>
<h2 id="Âü∫Á°ÄÊ¶ÇÂøµ">Âü∫Á°ÄÊ¶ÇÂøµ</h2>
<h3 id="ÂÜ∑ÂêØÂä®">ÂÜ∑ÂêØÂä®</h3>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693698465346.jpg"
	width="1024"
	height="200"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693698465346_hu463b78f3e15bdc2f729806aee7c07ab4_47087_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693698465346_hu463b78f3e15bdc2f729806aee7c07ab4_47087_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="512"
		data-flex-basis="1228px"
	
></p>
<blockquote>
<p>Ê≥®ÊÑèÔºöÂú®Êó•Â∏∏ÂºÄÂèëÊàñÊµãËØïÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÔºåËß¶ÂèëÂÜ∑ÂêØÂä®Áä∂ÊÄÅÔºå‰ºöÊâãÂä®kill appÔºåÁÑ∂ÂêéÁÇπÂáªÂêØÂä®„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÁöÑÂÜ∑ÂêØÂä®ÂèØËÉΩ‰ºö‰∏é‰∏äËø∞ÂÜ∑ÂêØÂä®ËøáÁ®ãÁöÑÊ≠•È™§Á®çÂæÆÂ∞ë‰∫õÔºåÂèØ‰ª•ÈÖçÂêàInstrumentË∞ÉËØïÈ™åËØÅÔºàËøô‰∏™Âú®ÊñáÁ´†ÁªìÂ∞æ‰ºöÂÅö‰ªãÁªçÔºâ„ÄÇÂõ†Ê≠§ÈÄöÂ∏∏Â¶ÇÊûúË¶ÅÊ®°ÊãüÊõ¥ÁúüÂÆûÂÖ®Èù¢ÁöÑÂÜ∑ÂêØÂä®ÔºåÂú®kill appÂêéÔºåÂÜçÊâìÂºÄ/Âπ∂Á®çÂæÆ‰ΩøÁî®Âá†‰∏™ÂÖ∂‰ªñapp„ÄÇ</p>
</blockquote>
<p>ÈÄöÂ∏∏ËØ¥ÁöÑÂêØÂä®Ôºå‰πüÊòØÊåáÁöÑÂÜ∑ÂêØÂä®ÔºõÂêØÂä®‰ºòÂåñÂ§ßÈÉ®ÂàÜ‰πüÊòØÂÅöÂÜ∑ÂêØÂä®ÈÉ®ÂàÜÁöÑÊÄßËÉΩ‰ºòÂåñ ÊöÇ‰∏îÂèØ‰ª•ÊääÂÜ∑ÂêØÂä®ÂàÜ‰∏∫Âá†‰∏™Èò∂ÊÆµÔºö</p>
<ul>
<li>T1: main‰πãÂâçÔºåÂä†ËΩΩAppÂèØÊâßË°åÊñá‰ª∂Âà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑÂä†ËΩΩ&amp;ÈìæÊé•Á≠âÂ∑•‰ΩúÔºåÊúÄÂêéÊâßË°åÂà∞main()ÂáΩÊï∞</li>
<li>T2: main‰πãÂêéÔºådidFinishLaunching‰πãÂâçÔºåËøôÈÉ®ÂàÜÂºÄÂèëÊòØÂèØ‰ª•ÁõëÂê¨Âà∞ÁöÑ</li>
<li>T3: didFinishLaunching‰πãÂêéÔºåÂêØÂä®È°µÈù¢Âá∫Áé∞‰πãÂâçÔºå‰πüÊòØÂèØ‰ª•ÁõëÂê¨ÁöÑ</li>
</ul>
<h3 id="ÁÉ≠ÂêØÂä®">ÁÉ≠ÂêØÂä®</h3>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693701475567.jpg"
	width="1024"
	height="119"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693701475567_hu3fc81ab65c962d5cb0f5c57ffb0fd083_36024_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693701475567_hu3fc81ab65c962d5cb0f5c57ffb0fd083_36024_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="860"
		data-flex-basis="2065px"
	
>
ÁÉ≠ÂêØÂä®ÁöÑÈò∂ÊÆµÂíåÁä∂ÊÄÅÈÉΩÊòØÂèØÁõëÂê¨ÁöÑÔºå‰∏çÂÅöËøáÂ§ö‰ªãÁªç„ÄÇ</p>
<h3 id="Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ">Â∫îÁî®Á®ãÂ∫èÁöÑÁä∂ÊÄÅ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÂêØÂä®Á®ãÂ∫è
</span></span><span class="line"><span class="cl">willFinishLaunchingWithOptions
</span></span><span class="line"><span class="cl">didFinishLaunchingWithOptions
</span></span><span class="line"><span class="cl">applicationDidBecomeActive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Êåâ‰∏ãhomeÈîÆ
</span></span><span class="line"><span class="cl">applicationWillResignActive
</span></span><span class="line"><span class="cl">applicationDidEnterBackground
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÂèåÂáªhomeÈîÆÔºåÂÜçÊâìÂºÄÁ®ãÂ∫è
</span></span><span class="line"><span class="cl">applicationWillEnterForeground
</span></span><span class="line"><span class="cl">applicationDidBecomeActive
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã">ÁÆÄÂçïÁêÜËß£ÁºñËØëËøáÁ®ã</h2>
<p>Â∫îÁî®Á®ãÂ∫èÂä†ËΩΩËøáÁ®ã‰∏≠‰ºö‰æùËµñÂæàÂ§öÂ∫ïÂ±ÇÂ∫ìÔºåËøô‰∫õÂ∫ïÂ±ÇÂ∫ìÂÖ∂ÂÆûÂ∞±ÊòØÂèØÊâßË°åÁöÑ‰ª£Á†ÅÁöÑ‰∫åËøõÂà∂ÔºåË¢´Êìç‰ΩúÁ≥ªÁªüÂÜôÂÖ•Âà∞ÂÜÖÂ≠ò„ÄÇ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703300492.jpg"
	width="1024"
	height="803"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703300492_hu5ad98b908d977cd3447717802411769e_67283_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703300492_hu5ad98b908d977cd3447717802411769e_67283_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="306px"
	
></p>
<h3 id="ÈùôÊÄÅÂ∫ì">ÈùôÊÄÅÂ∫ì</h3>
<p>ÊØîÂ¶ÇÔºö .a, .lib Âú®ÈìæÊé•Èò∂ÊÆµÔºå‰ºöÂ∞ÜÊ±áÁºñÁîüÊàêÁöÑÁõÆÊ†á‰∏éÂºïÁî®ÁöÑÂ∫ì‰∏ÄËµ∑ÈìæÊé•ÊâìÂåÖÂà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠„ÄÇ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703926730.jpg"
	width="1024"
	height="381"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703926730_hu4d5db889d6f348c29503610f781360a7_35346_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693703926730_hu4d5db889d6f348c29503610f781360a7_35346_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="268"
		data-flex-basis="645px"
	
></p>
<h3 id="Âä®ÊÄÅÂ∫ì">Âä®ÊÄÅÂ∫ì</h3>
<p>ÊØîÂ¶ÇÔºö frameworkÔºå.so, .dllÔºåUIKIT.frameworkÔºå libsystemÔºå libdispatchÔºålibobjc Âä®ÊÄÅÂ∫ìÊ†πÊçÆÈúÄË¶ÅÁºñËØëÔºåÂä®ÊÄÅÂä†ËΩΩÔºåÂú®ËøêË°åÊó∂ÊâçË¢´ËΩΩÂÖ•ÔºåËäÇÁ∫¶ËµÑÊ∫êÔºåÂáèÂ∞è‰ΩìÁßØ„ÄÇ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693704431403.jpg"
	width="1024"
	height="510"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693704431403_hu8283e8d13025e6a6413f82e079f47b7d_40440_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693704431403_hu8283e8d13025e6a6413f82e079f47b7d_40440_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<h2 id="ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£">ÂÆö‰ΩçÊ†∏ÂøÉÊ∫êÁ†ÅÂÖ•Âè£</h2>
<ol>
<li>
<p>mainÂáΩÊï∞ÔºåÊñ≠ÁÇπÂ†ÜÊ†àÔºàDebug/Debug Workflow/Always Show Disassembly ÂºÄÂêØÊ±áÁºñDebugÔºâÂèØ‰ª•ÁúãÂà∞ÊòØÊúÄÊó©ÊòØÔºödyldÁöÑstart:
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693705094212.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693705094212_hu440f4c49d49347e7b2265f13335d05fa_91966_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693705094212_hu440f4c49d49347e7b2265f13335d05fa_91966_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
</li>
<li>
<p>Âú®ÁâπÊÆäÊñπÊ≥ï + loadÔºàÊàñ+ (void)initializeÔºâÊñπÊ≥ïÔºåÂú®Ê≠§Êñ≠ÁÇπ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693708417366.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693708417366_hu440f4c49d49347e7b2265f13335d05fa_122444_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693708417366_hu440f4c49d49347e7b2265f13335d05fa_122444_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
</li>
</ol>
<h3 id="ÂàùÊé¢ÁªìËÆ∫">ÂàùÊé¢ÁªìËÆ∫Ôºö</h3>
<p>_dyld_start -&gt; +load -&gt; main -&gt; +initialize</p>
<blockquote>
<p>Ê∫êÁ†ÅÂ≠¶‰π†Â∞èTips</p>
<ol>
<li>OC Â∫ïÂ±ÇÊòØ C/C++/Ê±áÁºñ ÊâÄ‰ª•Ê∫êÁ†ÅÂ∏∏ËßÅÊêúÁ¥¢ÊäÄÂ∑ßÔºöXXXX(ÊàñËÄÖÂà†Èô§) XXXX:: ::XXXX XXXX(</li>
<li>‰∏ªÈÄªËæëÂæàÂèØËÉΩÂú® if else Âà§Êñ≠ Ôºõ while / do-whileÔºõ for ÈáåÈù¢</li>
<li>ÈÄöËøáËøîÂõûÂÄº - ÂÆö‰ΩçÊ†∏ÂøÉÈÄªËæë ÔºàÂ∞§ÂÖ∂Ê±áÁºñÔºåÈáçÁÇπÂÖ≥Ê≥®blÔºâ</li>
<li>ÁúãÂÆòÊñπÊ∫êÁ†ÅÔºåÂ§öÂÖ≥Ê≥®ÊúâÊ≥®ÈáäÁöÑÂú∞ÊñπÔºõ</li>
<li>Êäì‰∏ªÂπ≤ÔºåË∑≥ËøáÁ±ª‰ºº check / if-returnÈÄªËæëÔºõË∑≥ËøáÈ¢ÑÁºñËØëÈùû‰∏ªÊû∂ÊûÑÈÄªËæëÔºàiosÊû∂ÊûÑÔºöarm64Ôºâ</li>
</ol>
</blockquote>
<h3 id="__dyld_start">__dyld_start</h3>
<p>Êé•‰∏ãÊù•Â∞±Ë∑üÁùÄdyldÊ∫êÁ†Å ÂàùÊ≠•ÊêúÁ¥¢ _dyld_start
ÊêúÁ¥¢__dyld_start,Âè™Áúãarm64‰∏ãÁöÑ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710054906.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710054906_hu0cd249f03c5bd502fd99007d852ffcf7_175632_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710054906_hu0cd249f03c5bd502fd99007d852ffcf7_175632_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
>
Áúã‰∏çÊáÇÊ±áÁºñÊ≤°ÂÖ≥Á≥ªÔºåÁúãÂêéÈù¢ÁöÑÊ≥®ÈáäÔºåÂ§ßÊ¶ÇËÉΩÊòéÁôΩÂÖ∂Âê´‰πâÔºåÁõ¥Âà∞Âá∫Áé∞blË∑≥ËΩ¨ÔºåÂÜçÁªìÂêàÂÖ∂Ê≥®ÈáäÔºåÂü∫Êú¨ÂÆö‰ΩçÂà∞Ê†∏ÂøÉ‰ª£Á†ÅÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// call dyldbootstrap::start(app_mh, argc, argv, slide, dyld_mh, &amp;startGlue)
</span></span><span class="line"><span class="cl">	bl	__ZN13dyldbootstrap5startEPK12macho_headeriPPKclS2_Pm
</span></span><span class="line"><span class="cl">	mov	x16,x0                  // save entry point address in x16
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊêúÁ¥¢ dyldbootstrap::starÔºå::start Êú™ÊûúÔºåÁåúÊµãCÊñπÊ≥ïÔºåÊêúÁ¥¢start( ÔºåÁ°ÆÂÆödyld - star ÊúÄÁªàÂÖ•Âè£ÂáΩÊï∞„ÄÇ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710685212.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710685212_huf5b6d3156f9b6fbda99e7ba95c31a878_156680_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693710685212_huf5b6d3156f9b6fbda99e7ba95c31a878_156680_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
>
ËøôÊ†∑È¶ñÂÖàÂèØ‰ª•Á°ÆËÆ§ÊúÄÁªàÂÖ•Âè£ÊñπÊ≥ïuintptr_t start(&hellip;)</p>
<h3 id="ÂÖ•Âè£ÂáΩÊï∞-uintptr_t-start">ÂÖ•Âè£ÂáΩÊï∞ uintptr_t start(‚Ä¶)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">intptr_t start(const struct macho_header* appsMachHeader, int argc, const char* argv[], 
</span></span><span class="line"><span class="cl">				intptr_t slide, const struct macho_header* dyldsMachHeader,
</span></span><span class="line"><span class="cl">				uintptr_t* startGlue)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">			// rebaseDyldIfNeeded
</span></span><span class="line"><span class="cl">    	// mach_init
</span></span><span class="line"><span class="cl">    	// apple_guard_setup
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    	return dyld::_main(appsMachHeader, appsSlide, argc, argv, envp, apple, startGlue);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Ê†∏ÂøÉÂáΩÊï∞-dyld_main">Ê†∏ÂøÉÂáΩÊï∞ dyld::_main</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">uintptr_t _main(const macho_header* mainExecutableMH, uintptr_t mainExecutableSlide,
</span></span><span class="line"><span class="cl">                int argc, const char* argv[], const char* envp[], const char* apple[], 
</span></span><span class="line"><span class="cl">                uintptr_t* startGlue) {
</span></span><span class="line"><span class="cl">    // settupEnv ÁéØÂ¢ÉÂèòÈáèÁöÑÁõ∏ÂÖ≥Â§ÑÁêÜ
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">        checkEnvironmentVariables(envp);
</span></span><span class="line"><span class="cl">		defaultUninitializedFallbackPaths(envp);
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">    // load shared cacheÔºàÂÖ±‰∫´ÁºìÂ≠òÂ§ÑÁêÜÔºâ
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">        // load shared cache
</span></span><span class="line"><span class="cl">        checkSharedRegionDisable(...);
</span></span><span class="line"><span class="cl">        mapSharedCache();
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    // Â∞ÜdyldÂä†Âà∞UUIDÂàóË°®
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">        // add dyld itself to UUID list
</span></span><span class="line"><span class="cl">		addDyldImageToUUIDList();
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">    // ...
</span></span><span class="line"><span class="cl">    [1]reloadAllImages:
</span></span><span class="line"><span class="cl">        [1.1]mainExecutable ... (ÂÆû‰æãÂåñ‰∏ªÁ®ãÂ∫è)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    // [1.2]load any inserted libraries (Âä†ËΩΩ‰ªª‰ΩïÊèíÂÖ•Âä®ÊÄÅÂ∫ì)
</span></span><span class="line"><span class="cl">    if	( sEnv.DYLD_INSERT_LIBRARIES != NULL ) {
</span></span><span class="line"><span class="cl">        for (const char* const* lib = sEnv.DYLD_INSERT_LIBRARIES; *lib != NULL; ++lib) 
</span></span><span class="line"><span class="cl">            loadInsertedDylib(*lib);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    // [1.3.1]link main executable (ÈìæÊé•Â∫ì)
</span></span><span class="line"><span class="cl">    link(sMainExecutable, sEnv.DYLD_BIND_AT_LAUNCH, true, ImageLoader::RPathChain(NULL, NULL), -1);
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    // [1.3.2]link any inserted libraries
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    // [2]run all initializers (ËøêË°åÊâÄÊúâÂàùÂßãÂåñÁ®ãÂ∫è)
</span></span><span class="line"><span class="cl">	initializeMainExecutable();
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    // [3]notify any montoring proccesses that this process is about to enter main()
</span></span><span class="line"><span class="cl">    (ÈÄöÁü•ÁõëÂê¨dyld-main)
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    notifyMonitoringDyldMain();
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dyldÊ†∏ÂøÉÊ∫êÁ†ÅÊµÅÁ®ã">dyldÊ†∏ÂøÉÊ∫êÁ†ÅÊµÅÁ®ã</h2>
<h3 id="reloadallimages">reloadAllImages</h3>
<h4 id="ÂÆû‰æãÂåñ‰∏ªÁ®ãÂ∫è">ÂÆû‰æãÂåñ‰∏ªÁ®ãÂ∫è</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">static ImageLoaderMachO* instantiateFromLoadedImage(const macho_header* mh, uintptr_t slide, const char* path)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	// try mach-o loader
</span></span><span class="line"><span class="cl">	if ( isCompatibleMachO((const uint8_t*)mh, path) ) {
</span></span><span class="line"><span class="cl">		ImageLoader* image = ImageLoaderMachO::instantiateMainExecutable(mh, slide, path, gLinkContext);
</span></span><span class="line"><span class="cl">		addImage(image);
</span></span><span class="line"><span class="cl">		return (ImageLoaderMachO*)image;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// create image for main executable
</span></span><span class="line"><span class="cl">ImageLoader* ImageLoaderMachO::instantiateMainExecutable(const macho_header* mh, uintptr_t slide, const char* path, const LinkContext&amp; context)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">   ....
</span></span><span class="line"><span class="cl">	bool compressed;
</span></span><span class="line"><span class="cl">	unsigned int segCount; // ÊÆµÁöÑÊï∞Èáè
</span></span><span class="line"><span class="cl">	unsigned int libCount; // libÂ∫ìÁöÑÊï∞Èáè
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">	sniffLoadCommands(mh, path, false, &amp;compressed, &amp;segCount, &amp;libCount, context, &amp;codeSigCmd, &amp;encryptCmd);
</span></span><span class="line"><span class="cl">	// instantiate concrete class based on content of load commands
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li><code>instantiateFromLoadedImage</code> -&gt;<code>instantiateMainExecutable</code> -&gt;<code>sniffLoadCommands</code></li>
<li><code>addImage</code></li>
</ol>
<h4 id="Âä†ËΩΩ‰ªª‰ΩïÊèíÂÖ•Âä®ÊÄÅÂ∫ì">Âä†ËΩΩ‰ªª‰ΩïÊèíÂÖ•Âä®ÊÄÅÂ∫ì</h4>
<p>Âú®uintptr_t _main(‚Ä¶) ÂáΩÊï∞ÊúâÂ¶Ç‰∏ãÊ†∏ÂøÉÊµÅÁ®ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// load any inserted libraries
</span></span><span class="line"><span class="cl">if	( sEnv.DYLD_INSERT_LIBRARIES != NULL ) {
</span></span><span class="line"><span class="cl">	for (const char* const* lib = sEnv.DYLD_INSERT_LIBRARIES; *lib != NULL; ++lib) 
</span></span><span class="line"><span class="cl">		loadInsertedDylib(*lib);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>loadInsertedDylib</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// ‰ΩøÁî®Âä®ÊÄÅÂ∫ìÊ≥®ÂÖ•‰ª£Á†ÅÂèØ‰ª•ÂèÇËÄÉËøô‰∏™
</span></span><span class="line"><span class="cl">static void loadInsertedDylib(const char* path)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	ImageLoader* image = NULL;
</span></span><span class="line"><span class="cl">	unsigned cacheIndex;
</span></span><span class="line"><span class="cl">	try {
</span></span><span class="line"><span class="cl">		LoadContext context;
</span></span><span class="line"><span class="cl">        context.useSearchPaths		= false;
</span></span><span class="line"><span class="cl">		...
</span></span><span class="line"><span class="cl">		image = load(path, context, cacheIndex);
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	catch (const char* msg) {
</span></span><span class="line"><span class="cl">		...
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÊ†∑Â∞±ÂÆåÊàê‰∫ÜÂ∞ÜlibÂ∫ì‰ª•ÈïúÂÉèÊñá‰ª∂ÁöÑÂΩ¢ÂºèÂä†ËΩΩËøõÊù•‰∫ÜÔºåÂπ∂ÁîüÊàêÂØπÂ∫îÁöÑImageÔºåÂè™ÈúÄË¶ÅÂú®ÂêàÈÄÇÁöÑÂú∞ÊñπËøõË°åÊò†Â∞ÑÂç≥ÂèØ„ÄÇ</p>
<h4 id="ÈìæÊé•Â∫ì">ÈìæÊé•Â∫ì</h4>
<p>Âú®uintptr_t _main(‚Ä¶) ÂáΩÊï∞ÊúâÂ¶Ç‰∏ãÊ†∏ÂøÉÊµÅÁ®ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// link any inserted libraries
</span></span><span class="line"><span class="cl">// do this after linking main executable so that any dylibs pulled in by inserted 
</span></span><span class="line"><span class="cl">// dylibs (e.g. libSystem) will not be in front of dylibs the program uses
</span></span><span class="line"><span class="cl">if ( sInsertedDylibCount &gt; 0 ) {
</span></span><span class="line"><span class="cl">    for(unsigned int i=0; i &lt; sInsertedDylibCount; ++i) {
</span></span><span class="line"><span class="cl">        ImageLoader* image = sAllImages[i+1];
</span></span><span class="line"><span class="cl">        link(image, sEnv.DYLD_BIND_AT_LAUNCH, true, ImageLoader::RPathChain(NULL, NULL), -1);
</span></span><span class="line"><span class="cl">        image-&gt;setNeverUnloadRecursive();
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    // only INSERTED libraries can interpose
</span></span><span class="line"><span class="cl">    // register interposing info after all inserted libraries are bound so chaining works
</span></span><span class="line"><span class="cl">    for(unsigned int i=0; i &lt; sInsertedDylibCount; ++i) {
</span></span><span class="line"><span class="cl">        ImageLoader* image = sAllImages[i+1];
</span></span><span class="line"><span class="cl">        image-&gt;registerInterposing(gLinkContext);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">// Bind and notify for the inserted images now interposing has been registered
</span></span><span class="line"><span class="cl">if ( sInsertedDylibCount &gt; 0 ) {
</span></span><span class="line"><span class="cl">    for(unsigned int i=0; i &lt; sInsertedDylibCount; ++i) {
</span></span><span class="line"><span class="cl">        ImageLoader* image = sAllImages[i+1];
</span></span><span class="line"><span class="cl">        image-&gt;recursiveBind(gLinkContext, sEnv.DYLD_BIND_AT_LAUNCH, true);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÈÅçÂéÜ-link-images">ÈÅçÂéÜ link images</h5>
<ul>
<li>Ê†πÊçÆloadInsertedDylib ÂêéÁöÑ sInsertedDylibCountÔºåÈÅçÂéÜÂ∑≤ÁªèÂä†ËΩΩÁöÑÂä®ÊÄÅÂ∫ìÔºõ</li>
<li>Ê†πÊçÆImageLoaderMachO::instantiateMainExecutable -&gt; sAllImagesÈÅçÂéÜÊâßË°å ImageLoader* image = sAllImages[i+1];Ôºõ</li>
<li>link image
<ul>
<li>ÈÄíÂΩíÊìç‰Ωú</li>
</ul>
</li>
</ul>
<h5 id="ÈÄíÂΩíÊèíÂÖ•Âä†ËΩΩ">ÈÄíÂΩíÊèíÂÖ•/Âä†ËΩΩ</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void ImageLoader::link(const LinkContext&amp; context, bool forceLazysBound, bool preflightOnly, bool neverUnload, const RPathChain&amp; loaderRPaths, const char* imagePath)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">    // ÈÄíÂΩíÂä†ËΩΩ
</span></span><span class="line"><span class="cl">	this-&gt;recursiveLoadLibraries(context, preflightOnly, loaderRPaths, imagePath);
</span></span><span class="line"><span class="cl">	context.notifyBatch(dyld_image_state_dependents_mapped, preflightOnly);
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">	// ÈÄíÂΩíÂà∑Êñ∞‰æùËµñÂ∫ìÁöÑÂ±ÇÁ∫ß
</span></span><span class="line"><span class="cl">	this-&gt;recursiveUpdateDepth(context.imageCount());
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // Á¨¶Âè∑ÁªëÂÆö
</span></span><span class="line"><span class="cl">	__block uint64_t t2, t3, t4, t5;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">		this-&gt;recursiveRebase(context);
</span></span><span class="line"><span class="cl">		context.notifyBatch(dyld_image_state_rebased, false);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		t3 = mach_absolute_time();
</span></span><span class="line"><span class="cl">		if ( !context.linkingMainExecutable )
</span></span><span class="line"><span class="cl">			this-&gt;recursiveBindWithAccounting(context, forceLazysBound, neverUnload);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		t4 = mach_absolute_time();
</span></span><span class="line"><span class="cl">		if ( !context.linkingMainExecutable )
</span></span><span class="line"><span class="cl">			this-&gt;weakBind(context);
</span></span><span class="line"><span class="cl">		t5 = mach_absolute_time();
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">	this-&gt;recursiveGetDOFSections(context, dofs);
</span></span><span class="line"><span class="cl">	context.registerDOFs(dofs);
</span></span><span class="line"><span class="cl">	uint64_t t7 = mach_absolute_time();	
</span></span><span class="line"><span class="cl">	// interpose any dynamically loaded images
</span></span><span class="line"><span class="cl">	if ( !context.linkingMainExecutable &amp;&amp; (fgInterposingTuples.size() != 0) ) {
</span></span><span class="line"><span class="cl">		dyld3::ScopedTimer timer(DBG_DYLD_TIMING_APPLY_INTERPOSING, 0, 0, 0);
</span></span><span class="line"><span class="cl">		this-&gt;recursiveApplyInterposing(context);
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ËøêË°åÊâÄÊúâÂàùÂßãÂåñÁ®ãÂ∫è---run-all-initializers">ËøêË°åÊâÄÊúâÂàùÂßãÂåñÁ®ãÂ∫è - run all initializers</h3>
<ol>
<li>ÊâßË°åÊâÄÊúâÊèíÂÖ•ÁöÑdylibÊâßË°åÂàùÂßãÂåñ</li>
<li>ÊâßË°å‰∏ªÁ®ãÂ∫èÂàùÂßãÂåñ</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void initializeMainExecutable()
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    ....
</span></span><span class="line"><span class="cl">	// run initialzers for any inserted dylibs
</span></span><span class="line"><span class="cl">	ImageLoader::InitializerTimingList initializerTimes[allImagesCount()];
</span></span><span class="line"><span class="cl">	initializerTimes[0].count = 0;
</span></span><span class="line"><span class="cl">	const size_t rootCount = sImageRoots.size();
</span></span><span class="line"><span class="cl">	if ( rootCount &gt; 1 ) {
</span></span><span class="line"><span class="cl">		for(size_t i=1; i &lt; rootCount; ++i) {
</span></span><span class="line"><span class="cl">			sImageRoots[i]-&gt;runInitializers(gLinkContext, initializerTimes[0]);
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	// run initializers for main executable and everything it brings up 
</span></span><span class="line"><span class="cl">	sMainExecutable-&gt;runInitializers(gLinkContext, initializerTimes[0]);
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="runinitializers">runInitializers</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void ImageLoader::runInitializers(const LinkContext&amp; context, InitializerTimingList&amp; timingInfo)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">	processInitializers(context, thisThread, timingInfo, up);
</span></span><span class="line"><span class="cl">	context.notifyBatch(dyld_image_state_initialized, false);
</span></span><span class="line"><span class="cl">	...
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">void ImageLoader::processInitializers(const LinkContext&amp; context, mach_port_t thisThread,
</span></span><span class="line"><span class="cl">									 InitializerTimingList&amp; timingInfo, ImageLoader::UninitedUpwards&amp; images)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    // ÂàùÂßãÂåñÂáÜÂ§á
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">	// Calling recursive init on all images in images list, building a new list of
</span></span><span class="line"><span class="cl">	// uninitialized upward dependencies.
</span></span><span class="line"><span class="cl">    // ÈÅçÂéÜÂàùÂßãÂåñ
</span></span><span class="line"><span class="cl">	for (uintptr_t i=0; i &lt; images.count; ++i) {
</span></span><span class="line"><span class="cl">        // ÈÄíÂΩíÔºå‰∏Ä‰∏™‰∏™ÂàùÂßãÂåñ
</span></span><span class="line"><span class="cl">		images.images[i]-&gt;recursiveInitialization(context, thisThread, images.images[i]-&gt;getPath(), timingInfo, ups);
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="recursiveinitialization">recursiveInitialization</h5>
<p><code>notifySingle</code>ÔºåÈÄöÁü•<code>dyld_image_states</code>Áä∂ÊÄÅÁöÑÊîπÂèò <code>doInitialization</code>Ôºå ÂÆåÊàêÂàùÂßãÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void ImageLoader::recursiveInitialization(const LinkContext&amp; context, mach_port_t this_thread, const char* pathToInitialize,
</span></span><span class="line"><span class="cl">										  InitializerTimingList&amp; timingInfo, UninitedUpwards&amp; uninitUps)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	recursive_lock lock_info(this_thread);
</span></span><span class="line"><span class="cl">	recursiveSpinLock(lock_info);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	if ( fState &lt; dyld_image_state_dependents_initialized-1 ) {
</span></span><span class="line"><span class="cl">		uint8_t oldState = fState;
</span></span><span class="line"><span class="cl">		// break cycles
</span></span><span class="line"><span class="cl">		fState = dyld_image_state_dependents_initialized-1;
</span></span><span class="line"><span class="cl">		try {
</span></span><span class="line"><span class="cl">			// initialize lower level libraries first
</span></span><span class="line"><span class="cl">			....
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			// let objc know we are about to initialize this image
</span></span><span class="line"><span class="cl">            ....
</span></span><span class="line"><span class="cl">			context.notifySingle(dyld_image_state_dependents_initialized, this, &amp;timingInfo);
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			// initialize this image
</span></span><span class="line"><span class="cl">			bool hasInitializers = this-&gt;doInitialization(context);
</span></span><span class="line"><span class="cl">            // let anyone know we finished initializing this image
</span></span><span class="line"><span class="cl">            ....
</span></span><span class="line"><span class="cl">			context.notifySingle(dyld_image_state_initialized, this, NULL);
</span></span><span class="line"><span class="cl">			....
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">        ...
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	recursiveSpinUnLock();
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="doinitialization">doInitialization</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bool ImageLoaderMachO::doInitialization(const LinkContext&amp; context)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    ....
</span></span><span class="line"><span class="cl">	// mach-o has -init and static initializers
</span></span><span class="line"><span class="cl">	doImageInit(context);
</span></span><span class="line"><span class="cl">	doModInitFunctions(context);
</span></span><span class="line"><span class="cl">    ....
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">void ImageLoaderMachO::doModInitFunctions(const LinkContext&amp; context)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	if ( fHasInitializers ) {
</span></span><span class="line"><span class="cl">		const uint32_t cmd_count = ((macho_header*)fMachOData)-&gt;ncmds;
</span></span><span class="line"><span class="cl">		const struct load_command* const cmds = (struct load_command*)&amp;fMachOData[sizeof(macho_header)];
</span></span><span class="line"><span class="cl">		const struct load_command* cmd = cmds;
</span></span><span class="line"><span class="cl">		for (uint32_t i = 0; i &lt; cmd_count; ++i) {
</span></span><span class="line"><span class="cl">			if ( cmd-&gt;cmd == LC_SEGMENT_COMMAND ) {
</span></span><span class="line"><span class="cl">				for (const struct macho_section* sect=sectionsStart; sect &lt; sectionsEnd; ++sect) {
</span></span><span class="line"><span class="cl">					const uint8_t type = sect-&gt;flags &amp; SECTION_TYPE;
</span></span><span class="line"><span class="cl">					...
</span></span><span class="line"><span class="cl">                    Initializer* inits = (Initializer*)(sect-&gt;addr + fSlide);
</span></span><span class="line"><span class="cl">                    ...
</span></span><span class="line"><span class="cl">                    for (size_t j=0; j &lt; count; ++j) {
</span></span><span class="line"><span class="cl">                        Initializer func = inits[j];
</span></span><span class="line"><span class="cl">                        ....
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                    ....
</span></span><span class="line"><span class="cl">				}
</span></span><span class="line"><span class="cl">			}
</span></span><span class="line"><span class="cl">			cmd = (const struct load_command*)(((char*)cmd)+cmd-&gt;cmdsize);
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="notifysingle">notifySingle</h5>
<p>ËøôÈáå(*sNotifyObjCInit)(image-&gt;getRealPath(), image-&gt;machHeader());Â∞±ÊòØËé∑ÂèñÂáΩÊï∞ÊåáÈíàÂú∞ÂùÄÔºåÊâßË°åÂØπÂ∫îÁöÑÂáΩÊï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">static void notifySingle(dyld_image_states state, const ImageLoader* image, ImageLoader::InitializerTimingList* timingInfo)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">   //dyld::log(&#34;notifySingle(state=%d, image=%s)\n&#34;, state, image-&gt;getPath());
</span></span><span class="line"><span class="cl">   ....
</span></span><span class="line"><span class="cl">   if ( state == dyld_image_state_mapped ) {
</span></span><span class="line"><span class="cl">   	....
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">   if ( (state == dyld_image_state_dependents_initialized) &amp;&amp; (sNotifyObjCInit != NULL) &amp;&amp; image-&gt;notifyObjC() ) {
</span></span><span class="line"><span class="cl">   	....
</span></span><span class="line"><span class="cl">       (*sNotifyObjCInit)(image-&gt;getRealPath(), image-&gt;machHeader());
</span></span><span class="line"><span class="cl">   	....
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">   // mach message csdlc about dynamically unloaded images
</span></span><span class="line"><span class="cl">   if ( image-&gt;addFuncNotified() &amp;&amp; (state == dyld_image_state_terminated) ) {
</span></span><span class="line"><span class="cl">   	....
</span></span><span class="line"><span class="cl">   	notifyMonitoringDyld(true, 1, loadAddress, loadPath);
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâÄ‰ª•Âà∞Ê≠§ÔºåÂèØ‰ª•ÁúãÂá∫<code>sNotifyObjCInit</code>ÊòØ‰∏Ä‰∏™cÂáΩÊï∞ÊåáÈíàÂú∞ÂùÄÔºådyldÈÄöËøáËé∑ÂèñÂà∞<code>libobjc</code>ÂáΩÊï∞ÊåáÈíàÔºåÂèØ‰ª•ÊâßË°åÂà∞<code>libobjc</code>ÈáåÈù¢„ÄÇ Âú®dyldÊ∫êÁ†Å‰∏≠ÂÖ®Â±ÄÊêúÁ¥¢<code>sNotifyObjCInit</code>,ÂèØ‰ª•ÊâæÂà∞<code>sNotifyObjCInit</code>ËµãÂÄºÁöÑÂú∞ÊñπÂèëÁîüÂú®<code>registerObjCNotifiers</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void registerObjCNotifiers(_dyld_objc_notify_mapped mapped, _dyld_objc_notify_init init, _dyld_objc_notify_unmapped unmapped)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	// record functions to call
</span></span><span class="line"><span class="cl">	sNotifyObjCMapped	= mapped;
</span></span><span class="line"><span class="cl">	sNotifyObjCInit		= init;
</span></span><span class="line"><span class="cl">	sNotifyObjCUnmapped = unmapped;
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">	// &lt;rdar://problem/32209809&gt; call &#39;init&#39; function on all images already init&#39;ed (below libSystem)
</span></span><span class="line"><span class="cl">	for (std::vector&lt;ImageLoader*&gt;::iterator it=sAllImages.begin(); it != sAllImages.end(); it++) {
</span></span><span class="line"><span class="cl">		ImageLoader* image = *it;
</span></span><span class="line"><span class="cl">		if ( (image-&gt;getState() == dyld_image_state_initialized) &amp;&amp; image-&gt;notifyObjC() ) {
</span></span><span class="line"><span class="cl">			dyld3::ScopedTimer timer(DBG_DYLD_TIMING_OBJC_INIT, (uint64_t)image-&gt;machHeader(), 0, 0);
</span></span><span class="line"><span class="cl">			(*sNotifyObjCInit)(image-&gt;getRealPath(), image-&gt;machHeader());
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">void _dyld_objc_notify_register(_dyld_objc_notify_mapped    mapped,
</span></span><span class="line"><span class="cl">                                _dyld_objc_notify_init      init,
</span></span><span class="line"><span class="cl">                                _dyld_objc_notify_unmapped  unmapped)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	dyld::registerObjCNotifiers(mapped, init, unmapped);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëøõ‰∏ÄÊ≠•Âú®dyld‰∏≠Êü•Êâæ<code>registerObjCNotifiers</code>,<code>_dyld_objc_notify_register</code>ÔºåÂèØ‰ª•ÂàÜÊûêÂá∫ÔºåËøô‰∏™<code>register</code>ÂáΩÊï∞ÊòØ<code>extern</code>ÔºåÂπ∂‰∏çÊòØÂú®dyldÂèëËµ∑Ë∞ÉÁî®ÁöÑ„ÄÇËá≥‰∫éÂà∞Â∫ïÂú®Âì™ÈáåË∞ÉÁî®ÔºåÂêéÈù¢‰ºöËØ¶ÁªÜËØ¥Êòé„ÄÇ</p>
<h3 id="ÂõûË∞ÉÁõëÂê¨">ÂõûË∞ÉÁõëÂê¨</h3>
<h4 id="ÂèØ‰ª•ÁåúÊµãÊµÅÁ®ã">ÂèØ‰ª•ÁåúÊµãÊµÅÁ®ã</h4>
<p>Âà∞Ê≠§ÂèØ‰ª•ÁåúÊµãÔºå<code>dyld -&gt; libobjc</code> ÁöÑÊñπÂºèÊòØÈÄöËøáËøôÁßçÂáΩÊï∞ÊåáÈíàÁöÑÊñπÂºèËøõË°åÈÄö‰ø°, Â∫îËØ•ÊòØlibobjcÂú®Êüê‰∏™Âú∞ÊñπËøõË°å‰∫Ü<code>registerObjCNotifiers</code>ÔºåËøôÊ†∑<code>dyld start</code>ÂêéÔºåÊ†πÊçÆ‰∏äËø∞ÊµÅÁ®ãÔºåÂç≥ÂèØË∑≥ËΩ¨Âà∞libobjc„ÄÇËøôÁßç‰∏çÂêåÂ∫ì‰πãÈó¥ <code>register-notify</code>ÁöÑÊñπÂºèËøõË°åÈÄö‰ø°ÁöÑÂÆåÊàê‰ª£Á†ÅË∞ÉÁî®ÁöÑÔºåÊòéÊòæ‰ª£Á†ÅÂú®‰∏Ä‰∏™Â∫ìÈáåÈù¢‰∏ÄË°åË°åË∑üËøõ‰ª£Á†ÅÊòØË°å‰∏çÈÄöÁöÑ„ÄÇÊâÄ‰ª•Êé•‰∏ãÊù•ÈúÄË¶ÅÊçã‰∏Ä‰∏ãÊÄùË∑Ø„ÄÇ</p>
<h4 id="ÊèêÂá∫ÁñëÈóÆ">ÊèêÂá∫ÁñëÈóÆ</h4>
<p>ÈÇ£‰πàÁé∞Âú®ÊúâÁñëÈóÆ</p>
<ol>
<li>OCÊÄé‰πàÂ∞ÜËá™Â∑±ÁöÑÂáΩÊï∞ÊåáÈíà‰º†ÁªôdyldÁöÑÂë¢Ôºü</li>
<li>OCÂèàÊòØÂú®‰ªÄ‰πàÊó∂ÂÄôÂÆåÊàêÊ≥®ÂÜåÁöÑÂë¢Ôºü</li>
<li>OC-dyld‰πãÈó¥ÁöÑÁõ∏‰∫íÈÄö‰ø°ÊòØÂ¶Ç‰ΩïÈÖçÂêàÁöÑÂë¢Ôºü</li>
</ol>
<h2 id="libobjc-ÂêØÂä®Ê†∏ÂøÉÊ∫êÁ†ÅÂàÜÊûê">libobjc ÂêØÂä®Ê†∏ÂøÉÊ∫êÁ†ÅÂàÜÊûê</h2>
<p>Áõ¥Êé•‰ªéËãπÊûúÂÆòÁΩë‰∏ãËΩΩlibobjcÊ∫êÁ†Å„ÄÇ</p>
<h3 id="ÊâæÂà∞-_dyld_objc_notify_register-ÂÖ•Âè£">ÊâæÂà∞ _dyld_objc_notify_register ÂÖ•Âè£</h3>
<p>Âú®dyldÊ∫êÁ†ÅÂàÜÊûê‰∏≠ÔºåËÉΩÁúãÂá∫libobjcÊòØÈÄöËøá Ë∞ÉÁî®_dyld_objc_notify_registerÊù•ÂÆåÊàêÊ≥®ÂÜåÁöÑ„ÄÇÂú®libobjcÊ∫êÁ†Å‰∏≠ÊêúÁ¥¢_dyld_objc_notify_register,ÂèëÁé∞ÂÖ∂Âú®_objc_initÈáåË∞ÉÁî®ÔºåÂÆåÊàêÁöÑÂêëdyldÊ≥®ÂÜåÂáΩÊï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void _objc_init(void)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    ....
</span></span><span class="line"><span class="cl">    _dyld_objc_notify_register(&amp;map_images, load_images, unmap_image);
</span></span><span class="line"><span class="cl">    ....
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÄöËøá<code>_dyld_objc_notify_register(&amp;map_images, load_images, unmap_image)</code> ÂèØ‰ª•Âø´ÈÄüËß£Á≠î‰∫ÜÂâçÈù¢ÈóÆÈ¢ò1Ôºà‰ªÄ‰πàÊó∂ÂÄôÊ≥®ÂÜåÔºâÂíåÈóÆÈ¢ò2ÔºàÂ¶Ç‰ΩïÊ≥®ÂÜåÔºâ„ÄÇ Âπ∂‰∏îÊàë‰ª¨‰πüËÉΩÁúãÂà∞dyldÈáåÈù¢ÁöÑ<code>sNotifyObjCInit</code>Âç≥ÊòØ<code>libobjc</code>ÁöÑ<code>load_images</code>ÂáΩÊï∞Ôºå<code>sNotifyObjCMapped</code>ÊòØ<code>map_images</code>ÂáΩÊï∞„ÄÇ Áé∞Âú®ÂèàÊúâÊñ∞ÁöÑÈóÆÈ¢ò‰∫ßÁîü‰∫ÜÔºåËôΩÁÑ∂ÊòéÁ°Æ‰∫Ü<code>libobjc</code>Âêë<code>dyld</code>Ê≥®ÂÜåÂáΩÊï∞ÂèëÁîüÂú®<code>_objc_init</code>ÈáåÈù¢Ôºå‰ΩÜÊòØ<code>_objc_init</code>Âà∞Â∫ï‰ªÄ‰πàÊó∂ÂÄôËß¶ÂèëÁöÑËøòÊòØ‰∏çÁü•ÈÅì„ÄÇ</p>
<h3 id="build--run-libobjc">build &amp; run libobjc</h3>
<p>ÁÑ∂ÂêéÊ†πÊçÆËá™Â∑±ÁöÑXcodeÂíåÁ≥ªÁªüÁâàÊú¨ÔºåÂ∞ÜlibobjcÊ∫êÁ†ÅbuildÔºåÂπ∂runËµ∑Êù•„ÄÇËøôÈáåÂ∞±‰∏çÂÅöËØ¶ÁªÜ‰ªãÁªçÔºâ</p>
<blockquote>
<p><a class="link" href="objc818-canrun.zip" >objc818-canrun for Bigsur</a>
<a class="link" href="objc818-canrun.zip" >objc838-canrun for Monterey</a>
Âú®ËøôÈáåÂèØ‰ª•Ëá™Â∑±Ê†πÊçÆÂΩìÂâçÁéØÂ¢ÉÊâæ‰∏Ä‰∏™Ê∫êÁ†ÅÂ∞ùËØïË∑ë‰∏Ä‰∏™„ÄÇ
Ë∑ëÊ∫êÁ†ÅÁÆÄÂçïÁöÑÊÄùË∑ØÂ∞±ÊòØÂú®github‰∏äÊääÊ∫êÁ†Ådown‰∏ãÊù•ÔºåÁÑ∂ÂêéÁõ¥Êé•buildÔºåÈÇ£ÁßçÊâæ‰∏çÂà∞Á¨¶Âè∑ÁöÑÊä•ÈîôÁõ¥Êé•ÂÖàÊ≥®ÈáäÔºåÊâæ‰∏çÂà∞Êñá‰ª∂ÁöÑÂéªappleÁöÑopen sourceÊêúÁ¥¢‰∏ãÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºåÂ∞±Ê∑ªÂä†Âà∞Ëá™Â∑±ÁöÑÂ∑•Á®ã‰∏ãÈù¢„ÄÇÂü∫Êú¨ËøôÊ†∑Êìç‰ΩúÂÆå‰∫ÜÔºåÂ∞±Ê≤°error‰∫ÜÔºåÁÑ∂ÂêéÊñ∞Âª∫‰∏Ä‰∏™target, Â∞ÜobjcÂ∫ìÊ∑ªÂä†Âà∞targetÁöÑDependencies ÈáåÈù¢„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ
<img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693800524951.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693800524951_hu081b45b4958526e060399f25c13811d4_97727_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693800524951_hu081b45b4958526e060399f25c13811d4_97727_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
</blockquote>
<p>‰∏∫‰∫ÜÊòéÁ°Æ_objc_initÁöÑË∞ÉÁî®Êó∂Êú∫ÔºåÁÆÄÂçïÁöÑÊÄùË∑ØÂ∞±ÊòØÂú®_objc_initÈáåÈù¢Âä†‰∏Ä‰∏™Êñ≠ÁÇπÔºåÁúãÂ†ÜÊ†à„ÄÇ</p>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693801720569.jpg"
	width="1024"
	height="640"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693801720569_hub0f813d565a6228ad7209a42a9b7f8b5_197975_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693801720569_hub0f813d565a6228ad7209a42a9b7f8b5_197975_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
<h3 id="Á°ÆËÆ§Âü∫Á°ÄÊµÅÁ®ã">Á°ÆËÆ§Âü∫Á°ÄÊµÅÁ®ã</h3>
<p><code>dyld</code> -&gt;<code>libsystem</code> -&gt;<code>libdispatch</code> -&gt;<code>libobjc</code> -&gt;<code>_objc_init</code></p>
<p>‰ªéÊâìÂç∞ÁöÑËØ¶ÁªÜÂ†ÜÊ†à‰ø°ÊÅØÁúãÔºå<code>dyld_dyld_start</code>-&gt; ‚Ä¶. -&gt;<code>ImageLoaderMachO::doModInitFunction</code>Ëøô‰∏™ËøáÁ®ãÁöÑÊµÅÁ®ãÊ≠£Â•ΩË∑üÂâçÈù¢dyld Ê∫êÁ†ÅÂàÜÊûêÁöÑËøáÁ®ãÂêªÂêà‰∏ä‰∫Ü„ÄÇÂêéÈù¢ÊòØ<code>libSystem.B.dylib</code> <code>libSystem_initializer</code>(ÁåúÊµãËøô‰∏™ËøáÁ®ãÂ∫îËØ•ÊòØ<code>doModInitFunction</code>ÈáåÈù¢Ë∞ÉËµ∑ÁöÑ) -&gt;<code>libdispatch</code>-&gt;<code>libobjc</code></p>
<p>Âú®<code>dyld</code>‰∏≠ÁöÑÊêúÁ¥¢<code>image-&gt;getRealPath()</code> Âü∫Êú¨ÂèØ‰ª•Á°ÆÂÆö<code>libobjc</code>Ê≥®ÂÜåÁöÑÂáΩÊï∞ÁöÑË∞ÉÁî®Êó∂Êú∫„ÄÇÂú®<code>notifyBatchPartial</code>Âíå<code>notifySingle</code>Ê†πÊçÆ<code>dyld_image_states</code>Ëß¶Âèë‰∏çÂêåÁöÑÊ≥®ÂÜåÂáΩÊï∞„ÄÇ</p>
<blockquote>
<p>dyld_image_state_bound Ëß¶Âèë libjobcmap_images dyld_image_state_initialized Ëß¶Âèëlibobjc load_images</p>
</blockquote>
<h2 id="È™åËØÅÊµÅÁ®ã---ÈÖçÂêàlibsytemÊ∫êÁ†ÅlibdispatchÊ∫êÁ†Å">È™åËØÅÊµÅÁ®ã - ÈÖçÂêàlibSytemÊ∫êÁ†ÅÔºålibdispatchÊ∫êÁ†Å</h2>
<p>Âú®ÂâçÈù¢<code>dyld</code>Â∑≤ÁªèÂàÜÊûêÂà∞‰∫Ü<code>doModInitFunctions</code>ÈáåÈù¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">Initializer* inits = (Initializer*)(sect-&gt;addr + fSlide);
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">Initializer func = inits[j];
</span></span><span class="line"><span class="cl">// &lt;rdar://problem/8543820&amp;9228031&gt; verify initializers are in image
</span></span><span class="line"><span class="cl">if ( ! this-&gt;containsAddress(stripPointer((void*)func)) ) {
</span></span><span class="line"><span class="cl">  dyld::throwf(&#34;initializer function %p not in mapped image for %s\n&#34;, func, this-&gt;getPath());
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">if ( ! dyld::gProcessInfo-&gt;libSystemInitialized ) {
</span></span><span class="line"><span class="cl">  // &lt;rdar://problem/17973316&gt; libSystem initializer must run first
</span></span><span class="line"><span class="cl">  const char* installPath = getInstallPath();
</span></span><span class="line"><span class="cl">  if ( (installPath == NULL) || (strcmp(installPath, LIBSYSTEM_DYLIB_PATH) != 0) )
</span></span><span class="line"><span class="cl">    dyld::throwf(&#34;initializer in image (%s) that does not link with libSystem.dylib\n&#34;, this-&gt;getPath());
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">if ( context.verboseInit )
</span></span><span class="line"><span class="cl">  dyld::log(&#34;dyld: calling initializer function %p in %s\n&#34;, func, this-&gt;getPath());
</span></span><span class="line"><span class="cl">bool haveLibSystemHelpersBefore = (dyld::gLibSystemHelpers != NULL);
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  dyld3::ScopedTimer(DBG_DYLD_TIMING_STATIC_INITIALIZER, (uint64_t)fMachOData, (uint64_t)func, 0);
</span></span><span class="line"><span class="cl">  func(context.argc, context.argv, context.envp, context.apple, &amp;context.programVars);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞<code>dyld</code>Á°ÆÂÆûË¶ÅËµ∞Âπ∂Á°ÆÂÆöÂÖàÂà∞<code>libSystem</code>ÁöÑ<code>initializer</code></p>
<h3 id="dyld-ÂàùÂßãÂåñÂøÖÈ°ªÁ°Æ‰øùÂÖàÂÆåÊàê-libsystem-ÂàùÂßãÂåñ">dyld ÂàùÂßãÂåñÂøÖÈ°ªÁ°Æ‰øùÂÖàÂÆåÊàê libSystem ÂàùÂßãÂåñ</h3>
<p>ÂõûÂà∞dyld ÁöÑdoModInitFunctionsÁöÑÈÉ®ÂàÜ‰ª£Á†Å</p>
<h3 id="libsytem-initializer">libSytem initializer</h3>
<p>ÂÜçÂà∞<code>libSystem</code>Ê∫êÁ†Å‰∏≠ÊêúÁ¥¢<code>initializer</code>ÔºåÁ°ÆÂÆöÂÖ•Âè£ <code>libSystem_initializer</code>,Êé•‰∏ãÊù•Â∞±ÊòØ‰∏Ä‰∏™‰∏™ÊñπÊ≥ïË∑üË∏™Êü•ÁúãÔºåÊúÄÁªàÂèØ‰ª•ÁúãÂá∫ÊµÅÁ®ã‰∏∫ <code>libSystem_initializer</code>-&gt; <code>libdispatch_init</code></p>
<h3 id="libdispatch_init">libdispatch_init</h3>
<p>Âà∞<code>libdispatch</code>Ê∫êÁ†Å‰∏≠Â∏∏ËßÑÂàÜÊûêÊÄùË∑ØÔºåÊúÄÁªàÊµÅÁ®ã‰∏∫ <code>libdispatch_init</code>-&gt; <code>_os_object_init</code>-&gt; <code>_objc_init</code> Âà∞ËøôÈáåÔºåÈÄöËøáÊ∫êÁ†Å‰πüÈ™åËØÅ‰∫Ü ‰∏äËø∞Â†ÜÊ†àÁöÑÊµÅÁ®ã„ÄÇ</p>
<h2 id="ÂêØÂä®ÂÆåÊï¥ÊµÅÁ®ã">ÂêØÂä®ÂÆåÊï¥ÊµÅÁ®ã</h2>
<h3 id="ÁÆÄÂåñÊµÅÁ®ãÂõæ">ÁÆÄÂåñÊµÅÁ®ãÂõæ</h3>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805296135.jpg"
	width="1024"
	height="549"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805296135_hu20f457bb2a495be92f7cd7b0e4eb4e26_56472_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805296135_hu20f457bb2a495be92f7cd7b0e4eb4e26_56472_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<h3 id="ËØ¶ÁªÜÊµÅÁ®ãÂõæ">ËØ¶ÁªÜÊµÅÁ®ãÂõæ</h3>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933.jpg"
	width="1024"
	height="619"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933_hu0cfc4d1f5c3e28c9d5ab40ace509f822_113354_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805489933_hu0cfc4d1f5c3e28c9d5ab40ace509f822_113354_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="397px"
	
></p>
<h2 id="ÂÆûÈôÖÂ∫îÁî®">ÂÆûÈôÖÂ∫îÁî®</h2>
<h3 id="main‰πãÂâç---Ë∞ÉËØï--ÁõëÊµã">main‰πãÂâç - Ë∞ÉËØï &amp; ÁõëÊµã</h3>
<h4 id="xcodeÊâìÂç∞pre-mainÁöÑÊó∂Èó¥ÂºÄÂèëÁéØÂ¢Éxcode-dyld_print_statics--1">XcodeÊâìÂç∞pre-mainÁöÑÊó∂Èó¥ÔºöÂºÄÂèëÁéØÂ¢ÉXcode DYLD_PRINT_STATICS = 1</h4>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805852615.jpg"
	width="1024"
	height="278"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805852615_hub2a93ebef1094fa0f88cc40e01cee0d2_101974_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693805852615_hub2a93ebef1094fa0f88cc40e01cee0d2_101974_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="368"
		data-flex-basis="884px"
	
></p>
<ol>
<li><code>dylid loading time</code>:Âä®ÊÄÅÂ∫ìÂä†ËΩΩÊó∂Èó¥ÔºåËΩΩÂÖ•Âä®ÊÄÅÂ∫ì,Â∞ΩÂèØËÉΩ‰ΩøÁî®Á≥ªÁªüÂ∫ì,Ëá™ÂÆö‰πâÂ∫ìÔºåÊúÄÂ•Ω‰∏çË¶ÅÂ§ß‰∫é6‰∏™ÔºàappleÊé®ËçêÔºâ</li>
<li>rebaseÔºà‰øÆÊ≠£ÂÅèÁßªÊåáÈíà ASLR-‰øÆÂ§çÂÜÖÈÉ®ÊåáÈíàÔºâ / binding time ÔºàÂ§ñÈÉ®Á¨¶Âè∑ÁªëÂÆöÔºâ:ÔºàfishhookÔºâ</li>
<li><code>Objc set up time</code>Ôºå ÂáèÂ∞ëOCÁ±ªÔºåÊúâÁªüËÆ°2‰∏á‰∏™ocÁ±ªÂ¢ûÂä†800ÊØ´ÁßíÔºåswiftÊØîOCÁöÑÊïàÁéáÊõ¥È´òÔºåÂà†Èô§ÂºÉÁî®ÁöÑÁ±ªÔºàÊâæÂ∑•ÂÖ∑Ê£ÄÊµãÔºâ</li>
<li><code>initializer time load</code>ÊñπÊ≥ï ÊáíÂä†ËΩΩÔºåÂ∞ΩÈáèÊîæÂú®<code>initialize</code> ÂéªË∞ÉÁî®</li>
<li><code>slowest initializer</code>:ÊúÄÊÖ¢ÁöÑÂá†‰∏™Â∫ìÁöÑÊó∂Èó¥</li>
<li><code>libsystem</code></li>
</ol>
<h4 id="instrument---systemtrace--timeprofiler">Instrument - SystemTrace / TimeProfiler</h4>
<p>‰ºöËÆ∞ÂΩïÂêØÂä®ÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØ</p>
<h4 id="xcodeÈÖçÁΩÆlinkmapÊãøÂà∞linkmapÊñá‰ª∂ÂàÜÊûê">XcodeÈÖçÁΩÆLinkMapÔºåÊãøÂà∞LinkMapÊñá‰ª∂ÔºåÂàÜÊûê</h4>
<p><img src="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693807063070.jpg"
	width="1024"
	height="419"
	srcset="/p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693807063070_hu282fae3aa909e21319b61c0a0351cbbf_48865_480x0_resize_q75_box.jpg 480w, /p/ios%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD/16693807063070_hu282fae3aa909e21319b61c0a0351cbbf_48865_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="586px"
	
></p>
<h4 id="ÂÖ∂‰ªñ12‰∏çÊé®ËçêÂºÄÊãìÊÄùË∑Ø">ÂÖ∂‰ªñÔºà1Ôºå2‰∏çÊé®ËçêÔºåÂºÄÊãìÊÄùË∑ØÔºâ</h4>
<ol>
<li>ÂÆöÊó∂ÊäìÂèñ‰∏ªÁ∫øÁ®ã‰∏äÁöÑÊñπÊ≥ïË∞ÉÁî®Â†ÜÊ†àÔºàbacktraceÔºâÔºåËÆ°ÁÆó‰∏ÄÊÆµÊó∂Èó¥ÈáåÂêÑ‰∏™ÊñπÊ≥ïÁöÑËÄóÊó∂„ÄÇ</li>
<li>hook objc_msgSend ÊñπÊ≥ïËøõË°åhookÔºåÊéåÊè°ÊâÄÊúâÊñπÊ≥ïÁöÑÊâßË°åËÄóÊó∂ Ôºàlibffi, facebook fishhookÔºâ</li>
<li>Âú®ÂêØÂä®ÁöÑÁõ∏ÂÖ≥Êó∂Êú∫ÊèíÂÖ•Ëá™ÂÆö‰πâÁöÑÂä®ÊÄÅÂ∫ìÔºåÈÖçÂêàÊäÄÊúØÂüãÁÇπ</li>
<li>Apple-MetricsÔºàÂèØËá™ÂÆö‰πâÔºâ ÈÖçÂêàÂàÜÊûêÁ∫ø‰∏ä</li>
</ol>
<h2 id="objcÊ∫êÁ†Å‰∏ãËΩΩ">objcÊ∫êÁ†Å‰∏ãËΩΩ</h2>
<h3 id="objc818">objc818</h3>
<p><a class="link" href="objc818-canrun.zip" >objc818-canrun</a></p>
<h3 id="objc838">objc838</h3>
<p><a class="link" href="objc838-canrun.zip" >objc838-canrun</a></p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">Ê∂àÊÅØÂèëÈÄÅÊ∫êÁ†ÅÂ≠¶‰π†</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E5%88%86%E6%9E%90-%E5%9C%A8oc%E4%B8%AD-self-class-%E4%B8%8E-super-class-%E7%9A%84%E5%8C%BA%E5%88%AB/">
        
        

        <div class="article-details">
            <h2 class="article-title">ÂàÜÊûê Âú®OC‰∏≠ [self class] ‰∏é [super class] ÁöÑÂå∫Âà´</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2018 - 
        
        2023 YoyoWong
    </section>
    
    <section class="powerby">
        
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
